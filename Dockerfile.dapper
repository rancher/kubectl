FROM registry.suse.com/bci/bci-base:15.5

ARG DAPPER_HOST_ARCH
ENV ARCH $DAPPER_HOST_ARCH

RUN zypper -n in docker skopeo

ENV DAPPER_ENV REPO TAG DRONE_TAG DOCKER_USERNAME DOCKER_PASSWORD
ENV DAPPER_SOURCE /code
ENV DAPPER_DOCKER_SOCKET true
ENV HOME ${DAPPER_SOURCE}
WORKDIR ${DAPPER_SOURCE}

ENTRYPOINT ["./scripts/entry"]
CMD ["ci"]
